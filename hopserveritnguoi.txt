--TikTok : ThienDucScript 
-- https://discord.gg/qdNbh4npJ
local ScreenGui = Instance.new("ScreenGui")
local ImageButton = Instance.new("ImageButton")
local UICorner = Instance.new("UICorner")

ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

ImageButton.Parent = ScreenGui
ImageButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
ImageButton.BorderSizePixel = 0
ImageButton.Position = UDim2.new(0.10615778, 0, 0.16217947, 0)
ImageButton.Size = UDim2.new(0, 50, 0, 50)
ImageButton.Draggable = true
ImageButton.Image = "http://www.roblox.com/asset/?id=108610659764941"

UICorner.CornerRadius = UDim.new(1, 10) 
UICorner.Parent = ImageButton

ImageButton.MouseButton1Down:Connect(function()
    game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.End, false, game)
end)
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
repeat task.wait() until game:IsLoaded()
local Window = Fluent:CreateWindow({
    Title = "ThienDucHop Server",
    SubTitle = "by thienducdepzai",
    TabWidth = 157,
    Size = UDim2.fromOffset(450, 300),
    Acrylic = true,
    Theme = "Darker",
    MinimizeKey = Enum.KeyCode.End
})

Main =Window:AddTab({ Title="Hop Server" })

local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlaceId = game.PlaceId

-- HÃ m láº¥y danh sÃ¡ch server
local function ListServers(cursor)
    local url = "https://games.roblox.com/v1/games/" .. PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"
    if cursor then
        url = url .. "&cursor=" .. cursor
    end

    local success, response = pcall(function()
        return game:HttpGet(url)
    end)

    if success then
        task.wait(1.2) -- trÃ¡nh spam API
        return HttpService:JSONDecode(response)
    else
        warn("âš ï¸ Lá»—i láº¥y server:", response)
        return {data = {}, nextPageCursor = nil}
    end
end

-- TÃ¬m server Ã­t ngÆ°á»i, Æ°u tiÃªn server 1 ngÆ°á»i
local function FindBestServer()
    local cursor = nil
    local best = nil

    repeat
        local data = ListServers(cursor)
        for _, server in ipairs(data.data) do
            if server.playing > 0 and server.playing < server.maxPlayers then
                if server.playing == 1 then
                    return server -- Æ¯U TIÃŠN SERVER 1 NGÆ¯á»œI
                end
                if not best or server.playing < best.playing then
                    best = server
                end
            end
        end
        cursor = data.nextPageCursor
    until not cursor or best
    return best
end

-- Auto retry hop
local function AutoRetryHop()
    task.spawn(function()
        while true do
            local target = FindBestServer()
            if target then
                print("ğŸ‘‰ Thá»­ teleport tá»›i server:", target.id, "Players:", target.playing)
                local ok, err = pcall(function()
                    TeleportService:TeleportToPlaceInstance(PlaceId, target.id, LocalPlayer)
                end)
                if ok then
                    break -- náº¿u teleport thÃ nh cÃ´ng thÃ¬ dá»«ng
                else
                    warn("âš ï¸ Teleport tháº¥t báº¡i:", err, "â†’ thá»­ láº¡i sau 5s")
                end
            else
                warn("âŒ KhÃ´ng tÃ¬m Ä‘Æ°á»£c server phÃ¹ há»£p â†’ thá»­ láº¡i sau 5s")
            end
            task.wait(5)
        end
    end)
end

-- ğŸŸ¦ ThÃªm Button vÃ o Fluent UI
Main:AddButton({
    Title = "ğŸ”„ Hop Æ¯u TiÃªn Server 1 NgÆ°á»i",
    Description = "Join server Ã­t ngÆ°á»i, Æ°u tiÃªn server chá»‰ cÃ³ 1 ngÆ°á»i.",
    Callback = function()
        AutoRetryHop()
    end
})